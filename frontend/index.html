<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Voice Retention Agent - Demo</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo-title-container">
                    <img src="logo.png" alt="AI Agent Logo" class="app-logo">
                    <div class="title-section">
                        <h1>AI Voice Retention Agent</h1>
                        <p class="subtitle">Intelligent customer retention powered by Databricks AI</p>
                    </div>
                </div>
                <button id="settingsBtn" class="btn btn-icon" title="Settings">
                    ‚öôÔ∏è
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Panel: Customer Selection & Info -->
            <aside class="left-panel">
                <div class="panel-section">
                    <h2>Customer Selection</h2>
                    
                    <!-- Search with Type-Ahead -->
                    <div class="search-container">
                        <div class="search-input-wrapper">
                            <span class="search-icon">üîç</span>
                            <input 
                                type="text" 
                                id="customerSearch" 
                                class="customer-search" 
                                placeholder="Search by name or account #..."
                                autocomplete="off"
                            />
                            <button id="clearSearchBtn" class="clear-search-btn" style="display: none;">‚úï</button>
                        </div>
                        <div id="searchResults" class="search-results" style="display: none;">
                            <!-- Type-ahead results will appear here -->
                        </div>
                    </div>
                    
                    <!-- Or Separator -->
                    <div class="search-separator">
                        <span>or browse all</span>
                    </div>
                    
                    <!-- Traditional Dropdown -->
                    <select id="customerSelect" class="customer-select">
                        <option value="">Select a customer...</option>
                    </select>
                    
                    <button id="startCallBtn" class="btn btn-primary" disabled>
                        üìû Start Call
                    </button>
                </div>

                <div id="customerInfo" class="panel-section customer-info" style="display: none;">
                    <h3>Customer Profile</h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="label">Name:</span>
                            <span id="custName" class="value">-</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Plan:</span>
                            <span id="custPlan" class="value">-</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Monthly Bill:</span>
                            <span id="custBill" class="value">-</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Tenure:</span>
                            <span id="custTenure" class="value">-</span>
                        </div>
                        <div class="info-item">
                            <span class="label">Status:</span>
                            <span id="custStatus" class="value">-</span>
                        </div>
                        <div class="info-item">
                            <span class="label">LTV:</span>
                            <span id="custLTV" class="value">-</span>
                        </div>
                    </div>
                </div>

                <div id="conversationState" class="panel-section conversation-state" style="display: none;">
                    <h3>AI Analysis</h3>
                    <div class="state-item">
                        <span class="label">Intent:</span>
                        <span id="intentBadge" class="badge badge-neutral">-</span>
                    </div>
                    <div class="state-item">
                        <span class="label">Sentiment:</span>
                        <span id="sentimentBadge" class="badge badge-neutral">-</span>
                    </div>
                    <div class="state-item">
                        <span class="label">Urgency:</span>
                        <div class="urgency-meter">
                            <div id="urgencyBar" class="urgency-bar" style="width: 0%"></div>
                            <span id="urgencyText" class="urgency-text">0/10</span>
                        </div>
                    </div>
                    <div class="state-item">
                        <span class="label">Language:</span>
                        <span id="languageBadge" class="badge badge-info">-</span>
                    </div>
                </div>

                <div id="offersPanel" class="panel-section offers-panel" style="display: none;">
                    <h3>Retention Offers</h3>
                    <div id="offersList" class="offers-list">
                        <!-- Offers will be dynamically added here -->
                    </div>
                </div>
            </aside>

            <!-- Center Panel: Conversation -->
            <main class="center-panel">
                <div class="conversation-header">
                    <div class="status-indicator">
                        <span id="callStatus" class="status-dot"></span>
                        <span id="callStatusText">No active call</span>
                    </div>
                    <div class="call-controls">
                        <button id="endCallBtn" class="btn btn-danger" disabled>
                            üìû End Call
                        </button>
                        <button id="transferBtn" class="btn btn-warning" disabled>
                            üë§ Transfer to Agent
                        </button>
                    </div>
                </div>

                <div id="conversationArea" class="conversation-area">
                    <div class="welcome-message">
                        <h2>Welcome to the AI Retention Agent Demo</h2>
                        <p>Select a customer scenario from the left panel to begin.</p>
                        <ul class="features-list">
                            <li>üéØ Real-time intent detection</li>
                            <li>üòä Sentiment analysis</li>
                            <li>üíº Personalized retention offers</li>
                            <li>üåê Bilingual support (English/Spanish)</li>
                            <li>üé§ Voice and text input</li>
                        </ul>
                    </div>
                </div>

                <div id="inputArea" class="input-area" style="display: none;">
                    <!-- Voice Button Row (Top) -->
                    <div class="voice-button-row">
                        <button id="voiceBtn" class="btn btn-voice-large" title="Voice Input">
                            <span id="voiceBtnText">üé§ Click To Speak</span>
                        </button>
                    </div>
                    
                    <div id="voiceStatus" class="voice-status" style="display: none;">
                        <span class="recording-indicator"></span>
                        <span id="recordingText">Recording... <span id="recordingTimer">0.0s</span></span>
                    </div>
                    
                    <!-- Text Input Row (Bottom) -->
                    <div class="text-input-row">
                        <input 
                            type="text" 
                            id="messageInput" 
                            class="message-input" 
                            placeholder="Or type your message here..."
                            disabled
                        />
                        <button id="sendBtn" class="btn btn-primary" disabled>
                            Send
                        </button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal" style="display: none;">
        <div class="modal-content modal-settings">
            <div class="modal-header">
                <h2>‚öôÔ∏è Settings</h2>
                <button class="modal-close" onclick="closeSettingsModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>Voice Input Configuration</h3>
                    <div class="setting-item">
                        <label for="settingsTranscriptionMethod" class="setting-label">
                            <span class="label-text">Transcription Method:</span>
                            <span class="label-description">Choose how voice input is processed</span>
                        </label>
                        <select id="settingsTranscriptionMethod" class="transcription-select">
                            <option value="webspeech">üöÄ Web Speech API (Free, Real-time)</option>
                            <option value="backend">‚òÅÔ∏è Backend Transcription (Accurate, Costs $)</option>
                        </select>
                    </div>
                    <div class="setting-info">
                        <div class="info-card" id="webspeechInfo">
                            <h4>üöÄ Web Speech API</h4>
                            <ul>
                                <li>‚úÖ Free - No API costs</li>
                                <li>‚úÖ Real-time - Instant transcription</li>
                                <li>‚úÖ Browser-based - Works in Chrome, Edge, Safari</li>
                                <li>‚ö†Ô∏è Accuracy: 85-95% for English</li>
                            </ul>
                        </div>
                        <div class="info-card" id="backendInfo" style="display: none;">
                            <h4>‚òÅÔ∏è Backend Transcription</h4>
                            <ul>
                                <li>‚úÖ Best accuracy - 95-99%</li>
                                <li>‚úÖ Multi-format support</li>
                                <li>‚ö†Ô∏è Costs money - $0.006 per minute</li>
                                <li>‚ö†Ô∏è Slight delay for processing</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeSettingsModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Transfer Summary Modal -->
    <div id="transferModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Transfer to Human Agent</h2>
                <button class="modal-close" onclick="closeTransferModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div id="transferSummary" class="transfer-summary">
                    <!-- Summary content will be inserted here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeTransferModal()">Close</button>
                <button class="btn btn-primary" onclick="confirmTransfer()">Confirm Transfer</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>Processing...</p>
    </div>

    <!-- Load configuration first -->
    <script src="config.js"></script>
    <!-- Then load app -->
    <script src="app.js"></script>
</body>
</html>

